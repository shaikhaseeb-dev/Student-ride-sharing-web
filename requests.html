<!DOCTYPE html>
<html>
<head>
    <title>Ride Requests</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
</head>
<body>
<div class="container mt-5">
    <h2>All Rides</h2>
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary mb-3">Back to Dashboard</a>
    
    {% with messages = get_flashed_messages() %}
      {% if messages %}
          {% for message in messages %}
              <div class="alert alert-info">{{ message }}</div>
          {% endfor %}
      {% endif %}
    {% endwith %}
    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Email</th>
                <th>Pickup</th>
                <th>Drop</th>
                <th>Time</th>
                <th>Seats</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for ride in requests %}
                <tr>
                    <td>{{ ride.user_email if ride.user_email is defined else ride.posted_by }}</td>
                    <td>{{ ride.pickup_location if ride.pickup_location is defined else 'N/A' }}</td>
                    <td>{{ ride.drop_location if ride.drop_location is defined else ride.destination }}</td>
                    <td>{{ ride.ride_time if ride.ride_time is defined else 'N/A' }}</td>
                    <td>{{ ride.seats if ride.seats is defined else ride.seats_available }}</td>
                    <td>{{ ride.status if ride.status is defined else 'offered' }}</td>
                    <td>
                        {% set seats = ride.seats if ride.seats is defined else ride.seats_available %}
                        {% if seats|int > 0 %}
                            <form method="POST" action="{{ url_for('book_ride', ride_id=ride._id) }}">
                                <button type="submit" class="btn btn-success btn-sm">Book Now</button>
                            </form>
                        {% else %}
                            <button class="btn btn-secondary btn-sm" disabled>Full</button>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
